============================= test session starts =============================
platform win32 -- Python 3.13.2, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\Daniel Simples\AppData\Local\Programs\Python\Python313\python.exe
cachedir: .pytest_cache
rootdir: F:\Code\Рекламщик
configfile: pytest.ini
plugins: anyio-4.9.0
collecting ... collected 425 items

tests/test_ad_contacts.py::TestAdContactsExtraction::test_extract_admin_contacts_from_description PASSED
tests/test_ad_contacts.py::TestAdContactsExtraction::test_extract_multiple_contacts PASSED
tests/test_ad_contacts.py::TestAdContactsExtraction::test_extract_t_me_links PASSED
tests/test_ad_contacts.py::TestAdContactsExtraction::test_extract_telegram_me_links PASSED
tests/test_ad_contacts.py::TestAdContactsExtraction::test_no_false_positives_own_username PASSED
tests/test_ad_contacts.py::TestAdContactsExtraction::test_extract_near_ad_keywords_high_confidence PASSED
tests/test_ad_contacts.py::TestAdContactsExtraction::test_extract_returns_contact_type PASSED
tests/test_ad_contacts.py::TestAdContactsExtraction::test_detect_bot_contacts PASSED
tests/test_ad_contacts.py::TestAdContactsExtraction::test_empty_description_returns_empty_list PASSED
tests/test_ad_contacts.py::TestAdContactsExtraction::test_no_contacts_returns_empty_list PASSED
tests/test_ad_contacts.py::TestAdContactsExtraction::test_extract_only_valid_usernames PASSED
tests/test_ad_contacts.py::TestAdContactsExtraction::test_confidence_scoring_logic PASSED
tests/test_ad_contacts.py::TestAdContactsDatabase::test_ad_contacts_json_column_exists PASSED
tests/test_ad_contacts.py::TestAdContactsDatabase::test_save_and_load_ad_contacts PASSED
tests/test_ad_contacts.py::TestAdContactsIntegration::test_contacts_extracted_during_scan PASSED
tests/test_database.py::TestCrawlerDBBasic::test_add_channel_new PASSED
tests/test_database.py::TestCrawlerDBBasic::test_add_channel_duplicate PASSED
tests/test_database.py::TestCrawlerDBBasic::test_add_channel_normalizes_username PASSED
tests/test_database.py::TestCrawlerDBBasic::test_get_channel_returns_record PASSED
tests/test_database.py::TestCrawlerDBBasic::test_get_channel_not_found PASSED
tests/test_database.py::TestCrawlerDBBasic::test_get_next_returns_waiting PASSED
tests/test_database.py::TestCrawlerDBBasic::test_get_next_respects_order PASSED
tests/test_database.py::TestCrawlerDBBasic::test_get_next_empty_returns_none PASSED
tests/test_database.py::TestCrawlerDBBasic::test_mark_processing_changes_status PASSED
tests/test_database.py::TestCrawlerDBBasic::test_mark_done_good PASSED
tests/test_database.py::TestCrawlerDBBasic::test_mark_done_bad PASSED
tests/test_database.py::TestCrawlerDBBasic::test_mark_done_with_category PASSED
tests/test_database.py::TestCrawlerDBBasic::test_mark_done_coalesce_category PASSED
tests/test_database.py::TestCrawlerDBBasic::test_set_category PASSED
tests/test_database.py::TestCrawlerDBBasic::test_delete_channel PASSED
tests/test_database.py::TestCrawlerDBBasic::test_delete_channel_nonexistent PASSED
tests/test_database.py::TestCrawlerDBBasic::test_requeue_channel PASSED
tests/test_database.py::TestCrawlerDBBasic::test_reset_processing PASSED
tests/test_database.py::TestCrawlerDBStats::test_get_stats_empty PASSED
tests/test_database.py::TestCrawlerDBStats::test_get_stats_counts PASSED
tests/test_database.py::TestCrawlerDBStats::test_get_category_stats PASSED
tests/test_database.py::TestCrawlerDBStats::test_get_uncategorized PASSED
tests/test_database.py::TestCrawlerDBRaceCondition::test_race_condition_demonstrates_problem SKIPPED
tests/test_database.py::TestCrawlerDBRaceCondition::test_race_condition_stress_test XFAIL
tests/test_database.py::TestCrawlerDBRaceCondition::test_get_next_atomic_no_duplicates PASSED
tests/test_database.py::TestCrawlerDBBreakdown::test_mark_done_with_breakdown PASSED
tests/test_database.py::TestCrawlerDBBreakdown::test_mark_done_with_content_v22 PASSED
tests/test_database.py::TestCrawlerDBExport::test_export_csv_basic PASSED
tests/test_database.py::TestCrawlerDBExport::test_export_csv_with_category_filter PASSED
tests/test_database.py::TestCrawlerDBContextManager::test_context_manager PASSED
tests/test_database.py::TestAllOrNothing::test_peek_next_returns_waiting PASSED
tests/test_database.py::TestAllOrNothing::test_peek_next_does_not_change_status PASSED
tests/test_database.py::TestAllOrNothing::test_peek_next_returns_same_channel PASSED
tests/test_database.py::TestAllOrNothing::test_peek_next_empty_returns_none PASSED
tests/test_database.py::TestAllOrNothing::test_claim_and_complete_success PASSED
tests/test_database.py::TestAllOrNothing::test_claim_and_complete_fails_if_not_waiting PASSED
tests/test_database.py::TestAllOrNothing::test_claim_and_complete_with_breakdown PASSED
tests/test_database.py::TestAllOrNothing::test_delete_if_waiting_success PASSED
tests/test_database.py::TestAllOrNothing::test_delete_if_waiting_fails_if_not_waiting PASSED
tests/test_database.py::TestAllOrNothing::test_parallel_crawlers_no_duplicates PASSED
tests/test_database.py::TestAllOrNothing::test_ctrl_c_simulation PASSED
tests/test_favorites_api.py::TestFavoritesTable::test_favorites_table_exists PASSED
tests/test_favorites_api.py::TestFavoritesTable::test_favorites_table_schema PASSED
tests/test_favorites_api.py::TestFavoritesTable::test_favorites_table_column_types PASSED
tests/test_favorites_api.py::TestFavoritesTable::test_favorites_unique_constraint PASSED
tests/test_favorites_api.py::TestFavoritesTable::test_favorites_different_users_same_channel PASSED
tests/test_favorites_api.py::TestFavoritesTable::test_favorites_same_user_different_channels PASSED
tests/test_favorites_api.py::TestFavoritesTable::test_favorites_added_at_default PASSED
tests/test_favorites_api.py::TestGetFavorites::test_get_favorites_empty PASSED
tests/test_favorites_api.py::TestGetFavorites::test_get_favorites_unauthorized PASSED
tests/test_favorites_api.py::TestGetFavorites::test_get_favorites_with_data PASSED
tests/test_favorites_api.py::TestAddFavorite::test_add_favorite_success PASSED
tests/test_favorites_api.py::TestAddFavorite::test_add_favorite_duplicate PASSED
tests/test_favorites_api.py::TestAddFavorite::test_add_favorite_unauthorized PASSED
tests/test_favorites_api.py::TestDeleteFavorite::test_delete_favorite_success PASSED
tests/test_favorites_api.py::TestDeleteFavorite::test_delete_favorite_not_found PASSED
tests/test_favorites_api.py::TestDeleteFavorite::test_delete_favorite_unauthorized PASSED
tests/test_forensics_regression.py::TestIdClusteringNormal::test_random_ids_no_penalty PASSED
tests/test_forensics_regression.py::TestIdClusteringNormal::test_wide_gap_ids_no_penalty PASSED
tests/test_forensics_regression.py::TestIdClusteringNormal::test_mixed_random_and_some_neighbors PASSED
tests/test_forensics_regression.py::TestIdClusteringFatality::test_all_neighbor_ids_triggers_fatality PASSED
tests/test_forensics_regression.py::TestIdClusteringFatality::test_exactly_30_percent_not_fatality PASSED
tests/test_forensics_regression.py::TestIdClusteringFatality::test_just_over_30_percent_triggers_fatality PASSED
tests/test_forensics_regression.py::TestIdClusteringFatality::test_fatality_penalty_value PASSED
tests/test_forensics_regression.py::TestGeoDcMismatch::test_all_native_dc_no_penalty PASSED
tests/test_forensics_regression.py::TestGeoDcMismatch::test_under_75_percent_foreign_no_penalty PASSED
tests/test_forensics_regression.py::TestGeoDcMismatch::test_over_75_percent_foreign_triggers_penalty PASSED
tests/test_forensics_regression.py::TestGeoDcMismatch::test_all_foreign_dc_max_penalty PASSED
tests/test_forensics_regression.py::TestGeoDcMismatch::test_non_ru_channel_no_penalty PASSED
tests/test_forensics_regression.py::TestGeoDcMismatch::test_users_without_dc_ignored PASSED
tests/test_forensics_regression.py::TestGeoDcMismatch::test_dc_distribution_tracked PASSED
tests/test_forensics_regression.py::TestPremiumDensity::test_zero_premium_penalty PASSED
tests/test_forensics_regression.py::TestPremiumDensity::test_low_premium_no_penalty_no_bonus PASSED
tests/test_forensics_regression.py::TestPremiumDensity::test_high_premium_bonus PASSED
tests/test_forensics_regression.py::TestPremiumDensity::test_exactly_5_percent_no_bonus PASSED
tests/test_forensics_regression.py::TestPremiumDensity::test_premium_count_accurate PASSED
tests/test_forensics_regression.py::TestMinUsersThreshold::test_under_10_users_skip_id_clustering PASSED
tests/test_forensics_regression.py::TestMinUsersThreshold::test_exactly_10_users_analyzed PASSED
tests/test_forensics_regression.py::TestMinUsersThreshold::test_full_analyze_with_insufficient_users PASSED
tests/test_forensics_regression.py::TestMinUsersThreshold::test_full_analyze_with_sufficient_users PASSED
tests/test_forensics_regression.py::TestMinUsersThreshold::test_premium_zero_penalty_requires_min_users PASSED
tests/test_forensics_regression.py::TestEdgeCases::test_empty_user_list PASSED
tests/test_forensics_regression.py::TestEdgeCases::test_single_user PASSED
tests/test_forensics_regression.py::TestEdgeCases::test_users_without_ids PASSED
tests/test_forensics_regression.py::TestEdgeCases::test_users_with_hidden_flags PASSED
tests/test_forensics_regression.py::TestEdgeCases::test_only_deleted_users_no_flag_penalty PASSED
tests/test_forensics_regression.py::TestEdgeCases::test_all_users_same_id PASSED
tests/test_forensics_regression.py::TestFullAnalyze::test_healthy_channel_no_penalties PASSED
tests/test_forensics_regression.py::TestFullAnalyze::test_bot_farm_multiple_penalties PASSED
tests/test_forensics_regression.py::TestFullAnalyze::test_penalty_accumulation PASSED
tests/test_forensics_regression.py::TestConstants::test_cluster_threshold PASSED
tests/test_forensics_regression.py::TestConstants::test_cluster_max_gap PASSED
tests/test_forensics_regression.py::TestConstants::test_cluster_penalty PASSED
tests/test_forensics_regression.py::TestConstants::test_geo_threshold PASSED
tests/test_forensics_regression.py::TestConstants::test_geo_penalty PASSED
tests/test_forensics_regression.py::TestConstants::test_premium_thresholds PASSED
tests/test_forensics_regression.py::TestConstants::test_min_users PASSED
tests/test_forensics_regression.py::TestConstants::test_dc_sets PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_clean_channel_low_conviction PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_scam_channel_high_conviction PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_f1_impossible_reach PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_f1_normal_reach PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_f2_flat_cv PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_f2_natural_cv PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_f3_dead_engagement PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_f6_disabled_comments PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_f6_enabled_comments PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_f11_suspicious_velocity PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_f12_effective_members PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_f13_young_fast_inactive_combo PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_virality_mitigation PASSED
tests/test_metrics.py::TestFraudConvictionSystem::test_conviction_scam_threshold_50_2 PASSED
tests/test_metrics.py::TestCheckInstantScam::test_insufficient_data_not_scam PASSED
tests/test_metrics.py::TestCheckInstantScam::test_telegram_scam_flag PASSED
tests/test_metrics.py::TestCheckInstantScam::test_telegram_fake_flag PASSED
tests/test_metrics.py::TestCheckInstantScam::test_no_views_is_scam PASSED
tests/test_metrics.py::TestCheckInstantScam::test_forwards_more_than_views_is_scam PASSED
tests/test_metrics.py::TestCheckInstantScam::test_reactions_more_than_views_is_scam PASSED
tests/test_metrics.py::TestCheckInstantScam::test_normal_channel_not_scam PASSED
tests/test_metrics.py::TestCheckReactionsEnabled::test_reactions_with_counts PASSED
tests/test_metrics.py::TestCheckReactionsEnabled::test_reactions_attribute_exists_but_empty PASSED
tests/test_metrics.py::TestCheckReactionsEnabled::test_reactions_attribute_none PASSED
tests/test_metrics.py::TestCheckReactionsEnabled::test_no_reactions_attribute PASSED
tests/test_metrics.py::TestCheckReactionsEnabled::test_empty_messages_list PASSED
tests/test_metrics.py::TestCheckReactionsEnabled::test_mixed_messages PASSED
tests/test_metrics.py::TestAnalyzePrivateInvites::test_no_links PASSED
tests/test_metrics.py::TestAnalyzePrivateInvites::test_public_links_only PASSED
tests/test_metrics.py::TestAnalyzePrivateInvites::test_private_links_over_60 PASSED
tests/test_metrics.py::TestAnalyzePrivateInvites::test_private_links_over_80 PASSED
tests/test_metrics.py::TestAnalyzePrivateInvites::test_all_private_links PASSED
tests/test_metrics.py::TestAnalyzePrivateInvites::test_crypto_combo PASSED
tests/test_metrics.py::TestAnalyzePrivateInvites::test_comments_disabled_combo PASSED
tests/test_metrics.py::TestCalculateCvViews::test_empty_views PASSED
tests/test_metrics.py::TestCalculateCvViews::test_single_view PASSED
tests/test_metrics.py::TestCalculateCvViews::test_identical_views PASSED
tests/test_metrics.py::TestCalculateCvViews::test_high_variation PASSED
tests/test_metrics.py::TestCalculateCvViews::test_low_variation PASSED
tests/test_metrics.py::TestCalculateReach::test_zero_members PASSED
tests/test_metrics.py::TestCalculateReach::test_normal_reach PASSED
tests/test_metrics.py::TestCalculateReach::test_impossible_reach PASSED
tests/test_metrics.py::TestCalculateViewsDecay::test_insufficient_messages PASSED
tests/test_metrics.py::TestCalculateViewsDecay::test_normal_decay PASSED
tests/test_metrics.py::TestCalculateForwardsRatio::test_no_views PASSED
tests/test_metrics.py::TestCalculateForwardsRatio::test_normal_ratio PASSED
tests/test_metrics.py::TestCalculateReactionRate::test_no_views PASSED
tests/test_metrics.py::TestCalculateReactionRate::test_with_reactions PASSED
tests/test_metrics.py::TestCalculatePostsPerDay::test_insufficient_messages PASSED
tests/test_metrics.py::TestCalculatePostsPerDay::test_normal_frequency PASSED
tests/test_metrics.py::TestCalculatePostsPerDay::test_spam_frequency PASSED
tests/test_metrics.py::TestGetChannelAgeDays::test_no_date PASSED
tests/test_metrics.py::TestGetChannelAgeDays::test_one_day_old PASSED
tests/test_metrics.py::TestGetChannelAgeDays::test_year_old PASSED
tests/test_metrics.py::TestGetMessageReactionsCount::test_no_reactions_attribute PASSED
tests/test_metrics.py::TestGetMessageReactionsCount::test_reactions_none PASSED
tests/test_metrics.py::TestGetMessageReactionsCount::test_empty_reactions PASSED
tests/test_metrics.py::TestGetMessageReactionsCount::test_with_reactions PASSED
tests/test_metrics.py::TestCalculateSourceDiversity::test_no_forwards PASSED
tests/test_metrics.py::TestCalculateSourceDiversity::test_single_source PASSED
tests/test_metrics.py::TestCalculateSourceDiversity::test_multiple_sources PASSED
tests/test_metrics.py::TestEdgeCases::test_fcs_empty_messages PASSED
tests/test_metrics.py::TestEdgeCases::test_fcs_minimal_data PASSED
tests/test_metrics.py::TestEdgeCases::test_check_instant_scam_empty_messages PASSED
tests/test_metrics.py::TestEdgeCases::test_reactions_enabled_with_none_reactions_object PASSED
tests/test_metrics_regression.py::TestFraudConvictionSystemWeights::test_all_factors_have_names PASSED
tests/test_metrics_regression.py::TestFraudConvictionSystemWeights::test_f1_weight_is_30_or_35 PASSED
tests/test_metrics_regression.py::TestFraudConvictionSystemWeights::test_f2_weight_is_20_or_25 PASSED
tests/test_metrics_regression.py::TestFraudConvictionSystemWeights::test_f3_weight_is_20 PASSED
tests/test_metrics_regression.py::TestFraudConvictionSystemWeights::test_f6_weight_is_15 PASSED
tests/test_metrics_regression.py::TestFraudConvictionSystemWeights::test_f7_weight_is_10 PASSED
tests/test_metrics_regression.py::TestFraudConvictionSystemWeights::test_f13_weight_is_30 PASSED
tests/test_metrics_regression.py::TestF1HollowReach::test_micro_channel_threshold_250 PASSED
tests/test_metrics_regression.py::TestF1HollowReach::test_small_channel_threshold_180 PASSED
tests/test_metrics_regression.py::TestF1HollowReach::test_medium_channel_threshold_150 PASSED
tests/test_metrics_regression.py::TestF1HollowReach::test_large_channel_threshold_130 PASSED
tests/test_metrics_regression.py::TestF1HollowReach::test_virality_alibi_forward_rate PASSED
tests/test_metrics_regression.py::TestF1HollowReach::test_comments_alibi PASSED
tests/test_metrics_regression.py::TestF1HollowReach::test_extreme_reach_gets_weight_35 PASSED
tests/test_metrics_regression.py::TestF5BotReactions::test_only_thumbsup_is_suspicious PASSED
tests/test_metrics_regression.py::TestF5BotReactions::test_thumbsup_and_heart_is_suspicious PASSED
tests/test_metrics_regression.py::TestF5BotReactions::test_diverse_reactions_not_suspicious PASSED
tests/test_metrics_regression.py::TestF5BotReactions::test_no_reactions_not_suspicious PASSED
tests/test_metrics_regression.py::TestF5BotReactions::test_bot_reactions_list PASSED
tests/test_metrics_regression.py::TestF7BotRegularity::test_regular_intervals_triggers PASSED
tests/test_metrics_regression.py::TestF7BotRegularity::test_irregular_intervals_not_suspicious PASSED
tests/test_metrics_regression.py::TestF7BotRegularity::test_insufficient_posts PASSED
tests/test_metrics_regression.py::TestF7BotRegularity::test_mixed_intervals PASSED
tests/test_metrics_regression.py::TestCheckInstantScam::test_insufficient_data_members PASSED
tests/test_metrics_regression.py::TestCheckInstantScam::test_insufficient_data_posts PASSED
tests/test_metrics_regression.py::TestCheckInstantScam::test_telegram_scam_flag_instant PASSED
tests/test_metrics_regression.py::TestCheckInstantScam::test_telegram_fake_flag_instant PASSED
tests/test_metrics_regression.py::TestCheckInstantScam::test_no_views_instant_scam PASSED
tests/test_metrics_regression.py::TestCheckInstantScam::test_forwards_exceed_views_instant_scam PASSED
tests/test_metrics_regression.py::TestCheckInstantScam::test_reactions_exceed_views_instant_scam PASSED
tests/test_metrics_regression.py::TestCheckInstantScam::test_conviction_threshold_50_2 PASSED
tests/test_metrics_regression.py::TestCheckInstantScam::test_conviction_threshold_70_1 PASSED
tests/test_metrics_regression.py::TestCheckInstantScam::test_conviction_threshold_80 PASSED
tests/test_metrics_regression.py::TestCheckInstantScam::test_clean_channel_not_scam PASSED
tests/test_metrics_regression.py::TestCheckInstantScam::test_verified_channel_mitigation PASSED
tests/test_metrics_regression.py::TestRegressionEdgeCases::test_empty_messages_no_crash PASSED
tests/test_metrics_regression.py::TestRegressionEdgeCases::test_single_message_no_crash PASSED
tests/test_metrics_regression.py::TestRegressionEdgeCases::test_zero_members_no_division_error PASSED
tests/test_metrics_regression.py::TestRegressionEdgeCases::test_zero_views_no_division_error PASSED
tests/test_metrics_regression.py::TestRegressionEdgeCases::test_none_reactions_no_crash PASSED
tests/test_metrics_regression.py::TestRegressionEdgeCases::test_empty_reactions_list_no_crash PASSED
tests/test_metrics_regression.py::TestRegressionEdgeCases::test_messages_without_dates_no_crash PASSED
tests/test_metrics_regression.py::TestRegressionEdgeCases::test_chat_without_date_no_crash PASSED
tests/test_metrics_regression.py::TestRegressionEdgeCases::test_negative_views_handled PASSED
tests/test_metrics_regression.py::TestRegressionEdgeCases::test_very_large_numbers PASSED
tests/test_metrics_regression.py::TestGetMessageReactionsCount::test_no_reactions_attribute PASSED
tests/test_metrics_regression.py::TestGetMessageReactionsCount::test_reactions_none PASSED
tests/test_metrics_regression.py::TestGetMessageReactionsCount::test_empty_reactions_list PASSED
tests/test_metrics_regression.py::TestGetMessageReactionsCount::test_single_reaction PASSED
tests/test_metrics_regression.py::TestGetMessageReactionsCount::test_multiple_reactions PASSED
tests/test_metrics_regression.py::TestGetMessageReactionsCount::test_zero_count_reactions PASSED
tests/test_raw_data_storage.py::TestRawDataColumnsExist::test_raw_messages_gz_column_exists PASSED
tests/test_raw_data_storage.py::TestRawDataColumnsExist::test_raw_users_gz_column_exists PASSED
tests/test_raw_data_storage.py::TestRawDataColumnsExist::test_raw_chat_json_column_exists PASSED
tests/test_raw_data_storage.py::TestRawDataColumnsExist::test_entities_json_column_exists PASSED
tests/test_raw_data_storage.py::TestRawDataColumnsExist::test_media_stats_json_column_exists PASSED
tests/test_raw_data_storage.py::TestRawDataStorage::test_raw_messages_gz_stores_blob SKIPPED
tests/test_raw_data_storage.py::TestRawDataStorage::test_raw_users_gz_stores_blob SKIPPED
tests/test_raw_data_storage.py::TestRawDataStorage::test_raw_chat_json_stores_text SKIPPED
tests/test_raw_data_storage.py::TestRawDataStorage::test_entities_json_stores_text SKIPPED
tests/test_raw_data_storage.py::TestRawDataStorage::test_media_stats_json_stores_text SKIPPED
tests/test_raw_data_storage.py::TestRawDataClaimAndComplete::test_claim_and_complete_stores_all_raw_data SKIPPED
tests/test_raw_data_storage.py::TestRawDataClaimAndComplete::test_claim_and_complete_with_null_raw_data SKIPPED
tests/test_raw_data_storage.py::TestChannelRecordRawDataFields::test_channel_record_has_raw_messages_gz SKIPPED
tests/test_raw_data_storage.py::TestChannelRecordRawDataFields::test_channel_record_has_raw_users_gz SKIPPED
tests/test_raw_data_storage.py::TestChannelRecordRawDataFields::test_channel_record_has_raw_chat_json SKIPPED
tests/test_raw_data_storage.py::TestChannelRecordRawDataFields::test_channel_record_has_entities_json SKIPPED
tests/test_raw_data_storage.py::TestChannelRecordRawDataFields::test_channel_record_has_media_stats_json SKIPPED
tests/test_raw_data_storage.py::TestRawMessageWrapperEntities::test_message_entities_extracted PASSED
tests/test_raw_data_storage.py::TestRawMessageWrapperEntities::test_message_entities_empty_when_none PASSED
tests/test_raw_data_storage.py::TestRawMessageWrapperMediaType::test_message_media_type_photo PASSED
tests/test_raw_data_storage.py::TestRawMessageWrapperMediaType::test_message_media_type_video PASSED
tests/test_raw_data_storage.py::TestRawMessageWrapperMediaType::test_message_media_type_document PASSED
tests/test_raw_data_storage.py::TestRawMessageWrapperMediaType::test_message_media_type_none PASSED
tests/test_raw_data_storage.py::TestRawMessageWrapperButtons::test_message_buttons_extracted PASSED
tests/test_raw_data_storage.py::TestRawMessageWrapperButtons::test_message_buttons_empty_when_no_markup PASSED
tests/test_raw_data_storage.py::TestRawMessageWrapperFullText::test_message_full_text_preserved PASSED
tests/test_raw_data_storage.py::TestRawMessageWrapperFullText::test_message_full_text_equals_message_for_short_text PASSED
tests/test_recalc_domain.py::TestTrustFactorNoPenalties::test_trust_factor_no_penalties PASSED
tests/test_recalc_domain.py::TestTrustFactorNoPenalties::test_trust_factor_healthy_forensics PASSED
tests/test_recalc_domain.py::TestTrustFactorNoPenalties::test_trust_factor_with_healthy_metrics PASSED
tests/test_recalc_domain.py::TestTrustFactorBotPenalty::test_trust_factor_id_clustering_suspicious PASSED
tests/test_recalc_domain.py::TestTrustFactorBotPenalty::test_trust_factor_zero_premium_penalty PASSED
tests/test_recalc_domain.py::TestTrustFactorIDClusteringFatality::test_trust_factor_id_clustering_fatality PASSED
tests/test_recalc_domain.py::TestTrustFactorGeoDcMismatch::test_trust_factor_geo_dc_mismatch PASSED
tests/test_recalc_domain.py::TestTrustFactorGeoDcMismatch::test_trust_factor_geo_dc_no_trigger PASSED
tests/test_recalc_domain.py::TestTrustFactorMultiplePenalties::test_trust_factor_multiple_penalties PASSED
tests/test_recalc_domain.py::TestTrustFactorMultiplePenalties::test_trust_factor_three_penalties_multiply PASSED
tests/test_recalc_domain.py::TestTrustFactorMinimumFloor::test_trust_factor_minimum_floor PASSED
tests/test_recalc_domain.py::TestTrustFactorMinimumFloor::test_trust_factor_extreme_penalties_floored PASSED
tests/test_recalc_domain.py::TestTrustFactorStatisticalPenalties::test_trust_factor_hollow_views PASSED
tests/test_recalc_domain.py::TestTrustFactorStatisticalPenalties::test_trust_factor_hollow_views_virality_alibi PASSED
tests/test_recalc_domain.py::TestTrustFactorStatisticalPenalties::test_trust_factor_zombie_engagement PASSED
tests/test_recalc_domain.py::TestTrustFactorGhostProtocol::test_trust_factor_ghost_channel PASSED
tests/test_recalc_domain.py::TestTrustFactorGhostProtocol::test_trust_factor_zombie_audience PASSED
tests/test_recalc_domain.py::TestTrustFactorConviction::test_trust_factor_conviction_critical PASSED
tests/test_recalc_domain.py::TestTrustFactorConviction::test_trust_factor_conviction_high PASSED
tests/test_recalc_domain.py::TestRawScorePerfectChannel::test_raw_score_perfect_channel PASSED
tests/test_recalc_domain.py::TestRawScorePerfectChannel::test_raw_score_quality_category PASSED
tests/test_recalc_domain.py::TestRawScoreDeadChannel::test_raw_score_dead_channel PASSED
tests/test_recalc_domain.py::TestRawScoreFloatingWeights::test_raw_score_floating_weights_no_comments PASSED
tests/test_recalc_domain.py::TestRawScoreFloatingWeights::test_raw_score_floating_weights_both_disabled PASSED
tests/test_recalc_domain.py::TestRawScoreCappedAt100::test_raw_score_capped_at_100 PASSED
tests/test_recalc_domain.py::TestRawScoreCategories::test_categories_structure PASSED
tests/test_recalc_domain.py::TestRawScoreCategories::test_category_totals_match_v48 PASSED
tests/test_recalc_domain.py::TestVerdictExcellent::test_verdict_excellent_at_75 PASSED
tests/test_recalc_domain.py::TestVerdictExcellent::test_verdict_excellent_above_75 PASSED
tests/test_recalc_domain.py::TestVerdictGood::test_verdict_good_at_55 PASSED
tests/test_recalc_domain.py::TestVerdictGood::test_verdict_good_range PASSED
tests/test_recalc_domain.py::TestVerdictMedium::test_verdict_medium_at_40 PASSED
tests/test_recalc_domain.py::TestVerdictMedium::test_verdict_medium_range PASSED
tests/test_recalc_domain.py::TestVerdictHighRisk::test_verdict_high_risk_at_25 PASSED
tests/test_recalc_domain.py::TestVerdictHighRisk::test_verdict_high_risk_range PASSED
tests/test_recalc_domain.py::TestVerdictScam::test_verdict_scam_below_25 PASSED
tests/test_recalc_domain.py::TestVerdictScam::test_verdict_scam_at_zero PASSED
tests/test_recalc_domain.py::TestVerdictDetermination::test_verdict_from_score_function PASSED
tests/test_recalc_domain.py::TestVerdictDetermination::test_verdict_thresholds_are_correct PASSED
tests/test_recalc_domain.py::TestTrustAndScoreIntegration::test_final_score_calculation PASSED
tests/test_recalc_domain.py::TestTrustAndScoreIntegration::test_final_score_with_penalty PASSED
tests/test_recalc_domain.py::TestExtractScoreInputNullHandling::test_extract_score_input_handles_null_values PASSED
tests/test_recalc_domain.py::TestExtractScoreInputNullHandling::test_extract_score_input_handles_all_null_breakdown PASSED
tests/test_recalc_domain.py::TestExtractTrustInputNullHandling::test_extract_trust_input_handles_null_forensics PASSED
tests/test_recalc_domain.py::TestExtractTrustInputNullHandling::test_extract_trust_input_handles_null_breakdown_metrics PASSED
tests/test_recalc_domain.py::TestRecalculateChannelNullHandling::test_recalculate_channel_skips_missing_breakdown PASSED
tests/test_recalc_domain.py::TestRecalculateChannelNullHandling::test_recalculate_channel_skips_none_breakdown PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_empty_breakdown PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_no_penalties PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_single_penalty PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_multiple_penalties PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_with_llm_factor PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_combined PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_floor_at_01 PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_ignores_invalid PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_multiplier_equals_1_ignored PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_multiplier_greater_than_1_ignored PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_llm_factor_equals_1_ignored PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_missing_trust_details PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_none_llm_analysis PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_empty_llm_analysis PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_llm_missing_factor_key PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_real_world_scenario PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_extreme_penalties_floor PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_rounding PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_zero_llm_factor PASSED
tests/test_recalculator.py::TestRecalculateTrustFromBreakdown::test_recalculate_trust_integer_multiplier PASSED
tests/test_scorer.py::TestScoreStructure::test_result_has_required_keys PASSED
tests/test_scorer.py::TestScoreStructure::test_score_in_valid_range PASSED
tests/test_scorer.py::TestScoreStructure::test_trust_factor_in_valid_range PASSED
tests/test_scorer.py::TestScoreStructure::test_verdict_is_valid PASSED
tests/test_scorer.py::TestScoreStructure::test_breakdown_structure PASSED
tests/test_scorer.py::TestScoreStructure::test_categories_structure PASSED
tests/test_scorer.py::TestScoreStructure::test_flags_structure PASSED
tests/test_scorer.py::TestScamDetection::test_telegram_scam_flag PASSED
tests/test_scorer.py::TestScamDetection::test_flat_views_detection PASSED
tests/test_scorer.py::TestScamDetection::test_impossible_reach_detection PASSED
tests/test_scorer.py::TestScamDetection::test_new_channel_insufficient_data PASSED
tests/test_scorer.py::TestGoodChannelScore::test_healthy_channel_gets_good_score PASSED
tests/test_scorer.py::TestGoodChannelScore::test_verified_channel_no_bonus PASSED
tests/test_scorer.py::TestGoodChannelScore::test_old_channel_age_bonus PASSED
tests/test_scorer.py::TestGoodChannelScore::test_young_channel_age_penalty PASSED
tests/test_scorer.py::TestFloatingWeights::test_comments_disabled_floating_weights PASSED
tests/test_scorer.py::TestFloatingWeights::test_reactions_disabled_floating_weights PASSED
tests/test_scorer.py::TestFloatingWeights::test_both_disabled_all_to_forward PASSED
tests/test_scorer.py::TestFloatingWeights::test_floating_weights_in_scoring PASSED
tests/test_scorer.py::TestTrustFactor::test_trust_factor_with_forensics PASSED
tests/test_scorer.py::TestTrustFactor::test_hidden_comments_penalty PASSED
tests/test_scorer.py::TestTrustFactor::test_high_conviction_penalty PASSED
tests/test_scorer.py::TestTrustFactor::test_bot_wall_detection PASSED
tests/test_scorer.py::TestTrustFactor::test_hollow_views_detection PASSED
tests/test_scorer.py::TestVerdicts::test_excellent_verdict PASSED
tests/test_scorer.py::TestVerdicts::test_good_verdict_threshold PASSED
tests/test_scorer.py::TestVerdicts::test_medium_verdict_threshold PASSED
tests/test_scorer.py::TestVerdicts::test_high_risk_verdict_threshold PASSED
tests/test_scorer.py::TestVerdicts::test_scam_verdict_threshold PASSED
tests/test_scorer.py::TestPointsConversion::test_cv_to_points_optimal_range PASSED
tests/test_scorer.py::TestPointsConversion::test_cv_viral_exception PASSED
tests/test_scorer.py::TestPointsConversion::test_reach_to_points_by_size PASSED
tests/test_scorer.py::TestPointsConversion::test_age_to_points_thresholds PASSED
tests/test_scorer.py::TestPointsConversion::test_decay_to_points_zones PASSED
tests/test_scorer.py::TestForensicsIntegration::test_id_clustering_fatality PASSED
tests/test_scorer.py::TestForensicsIntegration::test_premium_density_in_scoring PASSED
tests/test_scorer.py::TestGhostProtocol::test_ghost_channel_detection PASSED
tests/test_scorer.py::TestGhostProtocol::test_zombie_audience_detection PASSED
tests/test_scorer.py::TestWeightsConfiguration::test_raw_weights_sum_to_100 PASSED
tests/test_scorer.py::TestWeightsConfiguration::test_category_totals_match_weights PASSED
tests/test_scorer.py::TestSnapshotScores::test_snapshot_healthy_channel PASSED
tests/test_scorer.py::TestSnapshotScores::test_snapshot_scam_channel PASSED
tests/test_scorer.py::TestSnapshotScores::test_snapshot_no_comments_channel PASSED
tests/test_scorer_regression.py::TestCalculateFinalScoreKnownChannel::test_returns_dict_with_required_keys PASSED
tests/test_scorer_regression.py::TestCalculateFinalScoreKnownChannel::test_score_is_in_valid_range PASSED
tests/test_scorer_regression.py::TestCalculateFinalScoreKnownChannel::test_raw_score_is_in_valid_range PASSED
tests/test_scorer_regression.py::TestCalculateFinalScoreKnownChannel::test_trust_factor_is_in_valid_range PASSED
tests/test_scorer_regression.py::TestCalculateFinalScoreKnownChannel::test_known_channel_verdict_is_positive PASSED
tests/test_scorer_regression.py::TestCalculateFinalScoreKnownChannel::test_known_channel_score_above_threshold PASSED
tests/test_scorer_regression.py::TestCalculateFinalScoreKnownChannel::test_breakdown_contains_all_metrics PASSED
tests/test_scorer_regression.py::TestCalculateFinalScoreKnownChannel::test_categories_sum_equals_raw_score PASSED
tests/test_scorer_regression.py::TestTrustFactorWithForensics::test_healthy_users_high_trust PASSED
tests/test_scorer_regression.py::TestTrustFactorWithForensics::test_bot_farm_triggers_fatality PASSED
tests/test_scorer_regression.py::TestTrustFactorWithForensics::test_premium_users_improve_score PASSED
tests/test_scorer_regression.py::TestTrustFactorWithForensics::test_no_users_still_calculates PASSED
tests/test_scorer_regression.py::TestTrustFactorWithForensics::test_hidden_comments_penalty_applied PASSED
tests/test_scorer_regression.py::TestTrustFactorWithForensics::test_high_conviction_penalty_applied PASSED
tests/test_scorer_regression.py::TestVerdictThresholds::test_excellent_threshold_at_75 PASSED
tests/test_scorer_regression.py::TestVerdictThresholds::test_good_threshold_at_55 PASSED
tests/test_scorer_regression.py::TestVerdictThresholds::test_medium_threshold_at_40 PASSED
tests/test_scorer_regression.py::TestVerdictThresholds::test_high_risk_threshold_at_25 PASSED
tests/test_scorer_regression.py::TestVerdictThresholds::test_scam_threshold_below_25 PASSED
tests/test_scorer_regression.py::TestVerdictThresholds::test_new_channel_verdict_for_insufficient_data PASSED
tests/test_scorer_regression.py::TestRawWeightsApplied::test_weights_sum_to_100 PASSED
tests/test_scorer_regression.py::TestRawWeightsApplied::test_category_totals_match_weights PASSED
tests/test_scorer_regression.py::TestRawWeightsApplied::test_quality_category_is_42 PASSED
tests/test_scorer_regression.py::TestRawWeightsApplied::test_engagement_category_is_38 PASSED
tests/test_scorer_regression.py::TestRawWeightsApplied::test_reputation_category_is_20 PASSED
tests/test_scorer_regression.py::TestRawWeightsApplied::test_cv_views_max_is_12 PASSED
tests/test_scorer_regression.py::TestRawWeightsApplied::test_forward_rate_max_is_15 PASSED
tests/test_scorer_regression.py::TestRawWeightsApplied::test_comments_max_is_15 PASSED
tests/test_scorer_regression.py::TestRawWeightsApplied::test_er_trend_max_is_10 PASSED
tests/test_scorer_regression.py::TestPointConversionFunctions::test_cv_to_points_optimal_range PASSED
tests/test_scorer_regression.py::TestPointConversionFunctions::test_cv_to_points_too_flat PASSED
tests/test_scorer_regression.py::TestPointConversionFunctions::test_cv_to_points_extreme_high PASSED
tests/test_scorer_regression.py::TestPointConversionFunctions::test_age_to_points_thresholds PASSED
tests/test_scorer_regression.py::TestPointConversionFunctions::test_decay_to_points_healthy_organic PASSED
tests/test_scorer_regression.py::TestPointConversionFunctions::test_decay_to_points_viral_growth PASSED
tests/test_scorer_regression.py::TestPointConversionFunctions::test_decay_to_points_bot_wall PASSED
tests/test_scorer_regression.py::TestPointConversionFunctions::test_decay_to_points_budget_cliff PASSED
tests/test_scorer_regression.py::TestFloatingWeights::test_all_enabled_standard_weights PASSED
tests/test_scorer_regression.py::TestFloatingWeights::test_comments_disabled_redistributes PASSED
tests/test_scorer_regression.py::TestFloatingWeights::test_reactions_disabled_redistributes PASSED
tests/test_scorer_regression.py::TestFloatingWeights::test_both_disabled_all_to_forward PASSED
tests/test_scorer_regression.py::TestFloatingWeights::test_floating_weights_sum_preserved PASSED
tests/test_scorer_regression.py::TestTrustFactorPenalties::test_ghost_channel_penalty PASSED
tests/test_scorer_regression.py::TestTrustFactorPenalties::test_zombie_audience_penalty PASSED
tests/test_scorer_regression.py::TestTrustFactorPenalties::test_hollow_views_penalty PASSED
tests/test_scorer_regression.py::TestTrustFactorPenalties::test_hidden_comments_penalty_value PASSED
tests/test_scorer_regression.py::TestTrustFactorPenalties::test_budget_cliff_penalty PASSED
tests/test_scorer_regression.py::TestTrustFactorPenalties::test_trust_multipliers_compound PASSED
tests/test_scorer_regression.py::TestTrustFactorsConstants::test_id_clustering_fatality_is_zero PASSED
tests/test_scorer_regression.py::TestTrustFactorsConstants::test_id_clustering_suspicious_is_half PASSED
tests/test_scorer_regression.py::TestTrustFactorsConstants::test_geo_dc_mismatch_is_severe PASSED
tests/test_scorer_regression.py::TestTrustFactorsConstants::test_conviction_critical_value PASSED
tests/test_scorer_regression.py::TestTrustFactorsConstants::test_conviction_high_value PASSED
tests/test_scorer_regression.py::TestStabilityScoring::test_stability_to_points_healthy PASSED
tests/test_scorer_regression.py::TestStabilityScoring::test_stability_to_points_too_flat PASSED
tests/test_scorer_regression.py::TestStabilityScoring::test_stability_to_points_extreme_concentration PASSED
tests/test_scorer_regression.py::TestRegularityScoring::test_regularity_ideal_range PASSED
tests/test_scorer_regression.py::TestRegularityScoring::test_regularity_dead_channel PASSED
tests/test_scorer_regression.py::TestRegularityScoring::test_regularity_spam PASSED

============================== warnings summary ===============================
C:\Users\Daniel Simples\AppData\Local\Programs\Python\Python313\Lib\site-packages\pyrogram\sync.py:31
  C:\Users\Daniel Simples\AppData\Local\Programs\Python\Python313\Lib\site-packages\pyrogram\sync.py:31: DeprecationWarning: There is no current event loop
    main_loop = asyncio.get_event_loop()

tests/test_database.py: 68 warnings
  F:\Code\Рекламщик\scanner\database.py:1273: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    cursor.execute('''

tests/test_favorites_api.py::TestGetFavorites::test_get_favorites_empty
  C:\Users\Daniel Simples\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\applications.py:18: DeprecationWarning: 'HTTP_422_UNPROCESSABLE_ENTITY' is deprecated. Use 'HTTP_422_UNPROCESSABLE_CONTENT' instead.
    from fastapi.exception_handlers import (

tests/test_favorites_api.py::TestGetFavorites::test_get_favorites_empty
  C:\Users\Daniel Simples\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\applications.py:30: DeprecationWarning: 'HTTP_422_UNPROCESSABLE_ENTITY' is deprecated. Use 'HTTP_422_UNPROCESSABLE_CONTENT' instead.
    from fastapi.openapi.utils import get_openapi

tests/test_favorites_api.py::TestGetFavorites::test_get_favorites_empty
  F:\Code\Рекламщик\mini-app\backend\main.py:1569: DeprecationWarning: `regex` has been deprecated, please use `pattern` instead
    sort_by: str = Query("score", regex="^(score|members|scanned_at|trust_factor)$"),

tests/test_favorites_api.py::TestGetFavorites::test_get_favorites_empty
  F:\Code\Рекламщик\mini-app\backend\main.py:1570: DeprecationWarning: `regex` has been deprecated, please use `pattern` instead
    sort_order: str = Query("desc", regex="^(asc|desc)$"),

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
========== 411 passed, 13 skipped, 1 xfailed, 73 warnings in 23.39s ===========
