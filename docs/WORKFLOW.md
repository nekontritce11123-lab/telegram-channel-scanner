# Claude Code Workflow Cheatsheet

## Начало сессии

1. **Прочитать PROGRESS.md** — понять где остановились
2. **Проверить контекст:** `/context`
3. **Сформулировать конкретную задачу**

## Во время работы

| Ситуация | Действие |
|----------|----------|
| На 70% контекста | `/compact` с инструкцией сохранить важное |
| Смена темы | `/clear` и начать заново |
| Нужен файл | Grep/Glob сначала, потом Read конкретных строк |
| Большая задача | Task tool с subagent (изоляция контекста) |
| Ошибка/баг | Task tool с `vibe-coder:debugger` |

## Конец сессии

1. **Обновить PROGRESS.md:**
   - Что сделано
   - Что в процессе
   - TODO для следующей сессии
2. **Commit** если есть изменения

## Анти-паттерны (НЕ ДЕЛАТЬ)

| Плохо | Почему | Хорошо |
|-------|--------|--------|
| Ждать auto-compact | Теряет контекст (баг #20797) | Ручной /compact на 70% |
| Читать файлы через @ | 70% token overhead | Grep → Read конкретных строк |
| Смешивать задачи в одной сессии | Context pollution | /clear между задачами |
| Держать сессию часами | Деградация качества | Очистка после каждой задачи |
| Хранить план только в памяти | Потеря при сбросе | Записывать в PROGRESS.md |
| Читать целые файлы | Waste tokens | Read с offset/limit |

## Команды

| Команда | Когда использовать |
|---------|-------------------|
| `/compact` | На 70% контекста, с инструкцией что сохранить |
| `/clear` | Смена темы, начало новой задачи |
| `/context` | Проверить usage |
| `/mcp` | Управление серверами |
| `/stats` | Статистика сессии |
| `/resume` | Попробовать восстановить прошлую сессию |

## Оптимальный workflow для больших задач

```
1. Прочитать PROGRESS.md
2. Сформулировать задачу
3. Если >3 файлов — Task tool с Plan агентом
4. Работать по плану
5. На 70% контекста — /compact "сохрани план и прогресс"
6. После завершения — обновить PROGRESS.md
7. Commit
```

## Делегирование через Task tool

```
Explore agent — поиск по кодовой базе
Plan agent — планирование архитектуры
vibe-coder:debugger — диагностика ошибок
vibe-coder:code-reviewer — ревью кода
vibe-coder:tdd-test-writer — написание тестов
```

**Преимущество:** Каждый агент работает в изолированном контексте, не засоряет основную сессию.
